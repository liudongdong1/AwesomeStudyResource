(function(){var h=window,n=encodeURIComponent,s=h.document,d=h.lezhi,j=d.util,a=d.modules,c=d.variables,f,r=0,g,m,o,p;d.initEngine=function(){if(!c.referrer&&h.opener)try{c.referrer=h.opener.location.href}catch(j){}d.getConfigurations();f=d.config.global;if(h.ADMAX_CONFIG!=void 0)h.ADMAX_CONFIG.uuid=f.uuid,d.util.loadModule(d.variables.ADMAX_LINK);for(g=0,m=0;g<a.nodes.length;g++)if(o=a.nodes[g],p=a.config[g],p.adEnabled)c.ADS_JS_URL[m]||(m=0),p.adPreload&&d.ads.preload(g,o,c.ADS_JS_URL[m]),o.adsJsUrl=
c.ADS_JS_URL[m++];d.loadRecomm()};d.loadRecomm=function(q,h){if(q)f.url=q,f.hash=d.util.getHash(q);if(h)f.title=h;var e=["uuid="+f.uuid,"url="+f.url,"title="+n(f.title.replace(/#blz-insite/g,"")),"sitePrefix="+n(f.sitePrefix),"hash="+f.hash,"keywords="+j.getKeywords(),"referrer="+n(c.referrer),"mock="+f.mock,"timestamp="+ +new Date],b,k,i;for(b=0,i=1;b<a.nodes.length;b++){if(a.nodes[b].oldVersionId){e.push("type="+(f.source=a.config[b].source));if(a.isSetCount[b]&&(r=a.config[b].count==0?a.config[b].row*
a.config[b].col:a.config[b].count,a.nodes[b].lezhiStyle==c.STYLETYPE_300x250||a.nodes[b].lezhiStyle==c.STYLETYPE_200x200||a.nodes[b].lezhiStyle==c.STYLETYPE_250x250||a.nodes[b].lezhiStyle==c.STYLETYPE_125x125||a.nodes[b].lezhiStyle==c.STYLETYPE_610x100))d.modules.config[b].adCount=0;e.push("count="+r)}var l=a.config[b].source.split(","),g={};for(k=0;k<l.length;k++,i++)g[l[k]+":"+i]=a.config[b].count==0&&a.nodes[b].lezhiStyle==c.STYLETYPE_DEFAULT?a.config[b].col*a.config[b].row:a.config[b].count;d.modules.sourceCount[b]=
g}f.customTitle&&e.push("customTitle="+f.customTitle);f.customThumbnail&&e.push("customThumbnail="+f.customThumbnail);if(!(a.nodes.length==1&&a.nodes[0].oldVersionId)){l=[];g=0;for(b=0,i=1;b<a.nodes.length;b++)if(!a.nodes[b].oldVersionId){if(a.nodes[b].lezhiStyle==c.STYLETYPE_300x250||a.nodes[b].lezhiStyle==c.STYLETYPE_200x200||a.nodes[b].lezhiStyle==c.STYLETYPE_250x250||a.nodes[b].lezhiStyle==c.STYLETYPE_125x125||a.nodes[b].lezhiStyle==c.STYLETYPE_610x100)d.modules.config[b].adCount=0;for(k in a.sourceCount[b])a.isSetCount[b]&&
(g=a.config[b].count==0?a.config[b].row*a.config[b].col:a.sourceCount[b][k]),l.push('{"order":"'+i+'","recommendType":"'+k.split(":")[0]+'","count":"'+g+'","adCount":"'+a.config[b].adCount+'"}'),i++}e.push("types=["+l.join(",")+"]")}j.loadModule(c.LEZHI_PLUGIN_LINK+"&"+e.join("&"))};d.callback=function(g){var h=j.matchImage(),e,b;if(c.recommendation=g){d.getConfigurations(g.config);if(e=d.util.getElemById("bShareRecommDiv")){var k=[],i;b=a.nodes.length-1;i=a.config[b];k=i.source.split(",");d.modules.sourceCount[b]=
{};for(var l=0;l<k.length;l++)d.modules.sourceCount[b][k[l]]=i.count==0?i.col*i.row:i.count}if(g.bx&&s.images)(new Image).src="http://www.bznx.net/cms.gif?a=lezhi&c="+g.vid;g.thumbnail!==h&&h&&!f.customThumbnail&&j.loadModule(d.variables.LEZHI_CORRECT_LINK+"&"+["url="+f.url,"thumbnail="+n(h)].join("&"));for(e in a.nodes){if(a.nodes[e].lezhiStyle==c.STYLETYPE_DEFAULT)typeof d.render=="function"?(a.nodes[e].innerHTML="",d.render(c.recommendation,!0)):j.loadModule(c.LEZHI_STYLEDEFAULT_LINK);if(a.nodes[e].lezhiStyle==
c.STYLETYPE_300x250)typeof d.render300x250=="function"?(a.nodes[e].innerHTML="",d.render300x250(c.recommendation,!0)):j.loadModule(c.LEZHI_STYLE300x250_LINK);if(a.nodes[e].lezhiStyle==c.STYLETYPE_200x200)typeof d.render200x200=="function"?(a.nodes[e].innerHTML="",d.render200x200(c.recommendation,!0)):j.loadModule(c.LEZHI_STYLE200x200_LINK);if(a.nodes[e].lezhiStyle==c.STYLETYPE_250x250)typeof d.render250x250=="function"?(a.nodes[e].innerHTML="",d.render250x250(c.recommendation,!0)):j.loadModule(c.LEZHI_STYLE250x250_LINK);
if(a.nodes[e].lezhiStyle==c.STYLETYPE_125x125)typeof d.render125x125=="function"?(a.nodes[e].innerHTML="",d.render125x125(c.recommendation,!0)):j.loadModule(c.LEZHI_STYLE125x125_LINK);if(a.nodes[e].lezhiStyle==c.STYLETYPE_610x100)typeof d.render610x100=="function"?(a.nodes[e].innerHTML="",d.render610x100(c.recommendation,!0)):j.loadModule(c.LEZHI_STYLE610x100_LINK);a.nodes[e].lezhiStyle==c.STYLETYPE_CUSTOM&&j.loadModule(a.config[e].styleJs)}}};d.initEngine()})();
